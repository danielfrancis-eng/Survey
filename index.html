<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Intercom Test Page</title>
  <meta name="robots" content="noindex" />
  <style>
    body { margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial; background:#0b1220; color:#e8edf7; }
    .wrap { max-width: 720px; margin: 0 auto; padding: 48px 20px; }
    .card { border:1px solid rgba(255,255,255,.12); background: rgba(255,255,255,.05); border-radius: 16px; padding: 18px; }
    button { cursor:pointer; border-radius: 12px; padding: 10px 12px; border:1px solid rgba(255,255,255,.18); background: rgba(255,255,255,.06); color:#e8edf7; font-weight:600; }
    button:hover { background: rgba(255,255,255,.09); }
    code, pre { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; }
    .muted { opacity:.75; font-size:14px; line-height:1.4; }
    .row { display:flex; gap:10px; flex-wrap:wrap; margin-top:12px; }
    pre { margin: 10px 0 0; padding: 12px; border-radius: 12px; background: rgba(0,0,0,.25); border:1px solid rgba(255,255,255,.10); overflow:auto; }
    .pill { display:inline-block; padding: 4px 8px; border-radius: 999px; border:1px solid rgba(255,255,255,.14); background: rgba(255,255,255,.06); font-size: 12px; }
  </style>
</head>

<body>
  <div class="wrap">
    <h1>Intercom Test</h1>
    <p class="muted">Minimal page to verify Intercom Messenger + surveys. Anonymous visitors (no login).</p>

    <div class="card">
      <div class="muted">Actions:</div>
      <div class="row">
        <button onclick="window.Intercom && Intercom('show')">Open Messenger</button>
        <button onclick="window.Intercom && Intercom('hide')">Hide Messenger</button>
        <button onclick="window.Intercom && Intercom('showMessages')">Show Messages</button>
<button onclick="location.search='?intercom_survey_id=58105488'">
  Run Survey
</button>


      </div>

      <div class="row" style="margin-top:14px;">
        <span class="pill" id="ic-status">Intercom: loading…</span>
        <span class="pill" id="ic-api">api_base: —</span>
      </div>

      <p class="muted" style="margin-top:12px;">
        Console quick check: <code>window.Intercom && Intercom('show')</code>
      </p>

      <pre id="ic-debug" class="muted">intercomSettings: (waiting…)</pre>
    </div>
  </div>

  <!-- Intercom — anonymous visitors -->
  <script>
    // IMPORTANT:
    // Your network screenshot showed ping + launcher_settings returning 404.
    // That typically means api_base region mismatch.
    // This value is for US-hosted workspaces:
    window.intercomSettings = {
      app_id: "w2lma4ma",
      api_base: "https://api-iam.eu.intercom.io"
    };
  </script>

  <script>
    (function () {
      var w = window;
      var ic = w.Intercom;
      if (typeof ic === "function") {
        ic("reattach_activator");
        ic("update", w.intercomSettings);
      } else {
        var d = document;
        var i = function () { i.c(arguments); };
        i.q = [];
        i.c = function (args) { i.q.push(args); };
        w.Intercom = i;

        var l = function () {
          var s = d.createElement("script");
          s.type = "text/javascript";
          s.async = true;
          s.src = "https://widget.intercom.io/widget/" + w.intercomSettings.app_id;
          var x = d.getElementsByTagName("script")[0];
          x.parentNode.insertBefore(s, x);
        };

        if (document.readyState === "complete") l();
        else if (w.attachEvent) w.attachEvent("onload", l);
        else w.addEventListener("load", l, false);
      }
    })();
  </script>

  <!-- Optional lifecycle helpers (only needed in SPAs / logout flows) -->
  <script>
    function intercomBoot() {
      if (window.Intercom) Intercom('boot', window.intercomSettings);
    }
    function intercomUpdate() {
      if (window.Intercom) Intercom('update', window.intercomSettings);
    }
    function intercomShutdown() {
      if (window.Intercom) Intercom('shutdown');
    }

    // Tiny UI debug to confirm load
    (function poll() {
      var status = document.getElementById('ic-status');
      var api = document.getElementById('ic-api');
      var dbg = document.getElementById('ic-debug');

      api.textContent = "api_base: " + (window.intercomSettings && window.intercomSettings.api_base);

      if (typeof window.Intercom === "function") {
        status.textContent = "Intercom: loaded ✅";
        dbg.textContent = "intercomSettings:\n" + JSON.stringify(window.intercomSettings, null, 2);
      } else {
        status.textContent = "Intercom: loading…";
        dbg.textContent = "intercomSettings:\n" + JSON.stringify(window.intercomSettings, null, 2);
        setTimeout(poll, 300);
      }
    })();
  </script>
</body>
</html>
